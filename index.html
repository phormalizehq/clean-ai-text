<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Text Purifier | Clean ChatGPT & Claude Formatting</title>
    <link rel="stylesheet" href="style.css">  
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚ú®</text></svg>">
    <style>
        /* Adding a small style for the word frequency chips */
        .frequency-container {
            margin-top: 15px;
            padding: 10px;
            background: rgba(0,0,0,0.03);
            border-radius: 8px;
            font-size: 0.85em;
        }
        .dark-theme .frequency-container { background: rgba(255,255,255,0.05); }
        .freq-tag {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            margin: 3px;
            font-weight: bold;
        }
    </style>
</head>
<body id="bodyTag">

    <nav id="top">
        <div class="nav-container">
            <a href="javascript:void(0)" onclick="confirmRefresh()" class="logo" style="text-decoration: none;">‚ú® CleanTextApp</a>
            <div class="nav-links">
                <button class="theme-toggle" onclick="toggleTheme()" id="themeBtn">üåì Dark Mode</button>
            </div>
        </div>
    </nav>

    <div class="container">
        <header>
            <h1>‚ú® AI Text Purifier</h1>
            <p class="description">Format AI content, fix grammar, and check readability instantly.</p>
        </header>

        <div class="editor-wrapper">
            <div class="toolbar">
                <div class="find-replace-row">
                    <input type="text" id="findInput" placeholder="Find..." oninput="resetSearch()" onkeydown="handleEnter(event)">
                    <input type="text" id="replaceInput" placeholder="Replace..." onkeydown="handleEnter(event)">
                    <div class="toolbar-group">
                        <button onclick="highlightText()" style="background: var(--primary); color: white;">Find</button>
                        <button onclick="replaceText()" style="background: var(--primary); color: white;">Replace All</button>
                        <button onclick="clearFindReplace()" title="Clear find/replace boxes" style="background: #ff4d4d; color: white; min-width: 30px;">‚úï</button>
                    </div>
                </div>
                <div class="toolbar-group">
                    <button onclick="changeCase('upper')">UPPERCASE</button>
                    <button onclick="changeCase('lower')">lowercase</button>
                    <button onclick="changeCase('title')">Title Case</button>
                </div>
            </div>

            <textarea id="editor" oninput="updateCounts()" spellcheck="true" placeholder="Paste your AI response here..."></textarea>
            
            <div class="counter-bar">
                <div class="stats-left">
                    <span>Words: <b id="wordCount">0</b></span>
                    <span>Characters: <b id="charCount">0</b></span>
                </div>
                <div>
                    Readability: <b id="readabilityScore">N/A</b> 
                    <span id="readabilityLevel" class="readability-tag">Ready</span>
                </div>
            </div>

            <div id="frequencyArea" class="frequency-container" style="display:none;">
                <strong>Top Frequent Words:</strong>
                <div id="wordFreqList" style="margin-top: 5px;"></div>
            </div>
        </div>

        <div class="action-area">
            <button class="main-btn btn-purify" onclick="purifyText()">‚ú® Purify Text</button>
            <div class="secondary-actions">
                <button class="main-btn btn-copy" id="copyBtn" onclick="copyText()">üìã Copy</button>
                <button class="main-btn btn-clear" onclick="clearText()">üóëÔ∏è Clear</button>
            </div>
        </div>

        <div id="statusMessage" style="height: 24px; margin-top: 15px; text-align: center; font-weight: 600; color: var(--success); transition: opacity 0.3s; opacity: 0;"></div>
    </div>

    <footer>
        <p>&copy; 2026 CleanTextApp.com</p>
        <div style="margin-top: 15px;">
            <a href="#top" style="color: var(--primary); font-weight: bold; margin-right: 15px; text-decoration: none;">Home</a>
            <a href="how-to.html" style="color: var(--text-muted); margin-right: 15px; text-decoration: none;">How-To</a>
            <a href="about.html" style="color: var(--text-muted); margin-right: 15px; text-decoration: none;">About</a>
            <a href="contact.html" style="color: var(--text-muted); margin-right: 15px; text-decoration: none;">Contact</a>
            <a href="privacy.html" style="color: var(--text-muted); margin-right: 15px; text-decoration: none;">Privacy</a>
            <a href="terms.html" style="color: var(--text-muted); text-decoration: none;">Terms</a>
        </div>
    </footer>

    <script>
    // --- PURIFY LOGIC ---
    function purifyText() {
        let editor = document.getElementById('editor');
        let text = editor.value;
        if(!text) return;

        text = text.replace(/(\*\*|__)(.*?)\1/g, "$2")
                   .replace(/(\*|_)(.*?)\1/g, "$2")
                   .replace(/^#+\s+/gm, "")
                   .replace(/`{1,3}.*?`{1,3}/gs, "")
                   .replace(/\[([^\]]+)\]\(([^)]+)\)/g, "$1")
                   .replace(/^[*-]\s+/gm, "‚Ä¢ ");

        text = text.replace(/([a-zA-Z0-9])([^a-zA-Z0-9\-\/\s\.!?])([a-zA-Z0-9])/g, "$1$3");
        text = text.replace(/(^\s*|[.!?]\s+)([a-z])/g, (m) => m.toUpperCase());

        editor.value = text.trim();
        updateCounts();
        showStatus("Text Purified! ‚ú®");
    }

    // --- CASE CONVERSION ---
    function changeCase(type) {
        const editor = document.getElementById('editor');
        if (!editor || !editor.value) return; 

        if (type === 'upper') {
            editor.value = editor.value.toUpperCase();
        } else if (type === 'lower') {
            editor.value = editor.value.toLowerCase();
        } else if (type === 'title') {
            editor.value = editor.value.toLowerCase().replace(/\b\w/g, s => s.toUpperCase());
        }
        updateCounts();
        showStatus("Case Updated");
    }

    // --- WORD FREQUENCY LOGIC ---
    function updateFrequency(text) {
        const freqArea = document.getElementById('frequencyArea');
        const freqList = document.getElementById('wordFreqList');
        
        if (!text || text.length < 10) {
            freqArea.style.display = 'none';
            return;
        }

        const stopWords = new Set(['the', 'and', 'a', 'to', 'of', 'in', 'is', 'it', 'that', 'on', 'for', 'was', 'as', 'with', 'be', 'this']);
        const words = text.toLowerCase().match(/\b\w+\b/g);
        const counts = {};

        if (words) {
            words.forEach(w => {
                if (w.length > 1 && !stopWords.has(w)) {
                    counts[w] = (counts[w] || 0) + 1;
                }
            });
        }

        const sorted = Object.entries(counts)
            .sort((a, b) => b[1] - a[1])
            .slice(0, 8); // Top 8 words

        if (sorted.length > 0) {
            freqArea.style.display = 'block';
            freqList.innerHTML = sorted.map(([word, count]) => 
                `<span class="freq-tag">${word}: ${count}</span>`
            ).join('');
        } else {
            freqArea.style.display = 'none';
        }
    }

    // --- FIND & HIGHLIGHT ---
    let searchIndex = 0;
    function highlightText() {
        const editor = document.getElementById('editor');
        const findVal = document.getElementById('findInput').value;
        if (!findVal) return;

        const text = editor.value;
        const index = text.toLowerCase().indexOf(findVal.toLowerCase(), searchIndex);

        if (index !== -1) {
            editor.focus();
            editor.setSelectionRange(index, index + findVal.length);
            searchIndex = index + findVal.length;
            showStatus(`Found "${findVal}"`);
        } else {
            searchIndex = 0;
            showStatus("End of text reached");
        }
    }

    function resetSearch() { searchIndex = 0; }

    function clearFindReplace() {
        document.getElementById('findInput').value = "";
        document.getElementById('replaceInput').value = "";
        resetSearch();
    }

    // --- UTILITIES ---
    function updateCounts() {
        const text = document.getElementById('editor').value.trim();
        const words = text ? text.split(/\s+/).length : 0;
        const chars = text.length;
        document.getElementById('wordCount').innerText = words;
        document.getElementById('charCount').innerText = chars;
        updateFrequency(text);
    }

    function replaceText() {
        const findVal = document.getElementById('findInput').value;
        const replaceVal = document.getElementById('replaceInput').value;
        const editor = document.getElementById('editor');
        if (!findVal) return;
        const escapedFind = findVal.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        editor.value = editor.value.replace(new RegExp(escapedFind, 'g'), replaceVal);
        updateCounts();
        showStatus("Replaced All Instances");
    }

    function toggleTheme() {
        const body = document.getElementById('bodyTag');
        body.classList.toggle('dark-theme');
        const isDark = body.classList.contains('dark-theme');
        localStorage.setItem('preferred-theme', isDark ? 'dark' : 'light');
        document.getElementById('themeBtn').innerHTML = isDark ? '‚òÄÔ∏è Light' : 'üåì Dark';
    }

    window.onload = () => {
        if (localStorage.getItem('preferred-theme') === 'dark') {
            document.getElementById('bodyTag').classList.add('dark-theme');
            document.getElementById('themeBtn').innerHTML = '‚òÄÔ∏è Light';
        }
    };

    function handleEnter(e) { if (e.key === "Enter") replaceText(); }

    async function copyText() {
        const editor = document.getElementById('editor');
        try {
            await navigator.clipboard.writeText(editor.value);
            showStatus("Copied to clipboard!");
        } catch (err) { showStatus("Copy failed"); }
    }

    function clearText() {
        document.getElementById('editor').value = "";
        updateCounts();
        showStatus("Workspace Cleared ‚ú®");
    }

    function showStatus(msg) {
        const status = document.getElementById('statusMessage');
        status.innerText = msg;
        status.style.opacity = "1";
        setTimeout(() => { status.style.opacity = "0"; }, 2000);
    }

    function confirmRefresh() {
        if (confirm("Refresh page and clear all text?")) {
            window.location.reload();
        } else {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    }
    </script>
</body>
</html>
