<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Text Purifier | Clean ChatGPT & Claude Formatting</title>
    <link rel="stylesheet" href="style.css">  
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚ú®</text></svg>">
</head>
<body id="bodyTag">

    <nav id="top">
        <div class="nav-container">
            <a href="javascript:void(0)" onclick="confirmRefresh()" class="logo" style="text-decoration: none;">‚ú® CleanTextApp</a>
            <div class="nav-links">
                <button class="theme-toggle" onclick="toggleTheme()" id="themeBtn">üåì Dark Mode</button>
            </div>
        </div>
    </nav>

    <div class="container">
        <header>
            <h1>‚ú® AI Text Purifier</h1>
            <p class="description">Format AI content, fix grammar, and check readability instantly.</p>
        </header>

        <div class="editor-wrapper">
            <div class="toolbar">
                <div class="find-replace-row">
                    <input type="text" id="findInput" placeholder="Find..." onkeydown="handleEnter(event)">
                    <input type="text" id="replaceInput" placeholder="Replace..." onkeydown="handleEnter(event)">
                    <button onclick="replaceText()" style="background: var(--primary); color: white;">Replace All</button>
                </div>
                <div class="toolbar-group">
                    <button onclick="changeCase('upper')">UPPERCASE</button>
                    <button onclick="changeCase('lower')">lowercase</button>
                    <button onclick="toggleSpellcheck()" id="spellBtn" class="active">ABC‚úì</button>
                </div>
            </div>

            <textarea id="editor" oninput="updateCounts()" spellcheck="true" placeholder="Paste your AI response here..."></textarea>
            
            <div class="counter-bar">
                <div class="stats-left">
                    <span>Words: <b id="wordCount">0</b></span>
                    <span>Characters: <b id="charCount">0</b></span>
                </div>
                <div>
                    Readability: <b id="readabilityScore">N/A</b> 
                    <span id="readabilityLevel" class="readability-tag">Ready</span>
                </div>
            </div>
        </div>

        <div class="action-area">
            <button class="main-btn btn-purify" onclick="purifyText()">‚ú® Purify Text</button>
            <div class="secondary-actions">
                <button class="main-btn btn-copy" id="copyBtn" onclick="copyText()">üìã Copy</button>
                <button class="main-btn btn-clear" onclick="clearText()">üóëÔ∏è Clear</button>
            </div>
        </div>

        <div id="statusMessage" style="height: 24px; margin-top: 15px; text-align: center; font-weight: 600; color: var(--success); transition: opacity 0.3s; opacity: 0;"></div>
    </div>

    <footer>
        <p>&copy; 2026 CleanTextApp.com</p>
        <div style="margin-top: 15px;">
            <a href="#top" style="color: var(--primary); font-weight: bold; margin-right: 15px; text-decoration: none;">Home</a>
            <a href="how-to.html" style="color: var(--text-muted); margin-right: 15px; text-decoration: none;">How-To</a>
            <a href="about.html" style="color: var(--text-muted); margin-right: 15px; text-decoration: none;">About</a>
            <a href="contact.html" style="color: var(--text-muted); margin-right: 15px; text-decoration: none;">Contact</a>
            <a href="privacy.html" style="color: var(--text-muted); margin-right: 15px; text-decoration: none;">Privacy</a>
            <a href="terms.html" style="color: var(--text-muted); text-decoration: none;">Terms</a>
        </div>
    </footer>

    <script>
    // --- UPDATED PURIFY LOGIC ---
    function purifyText() {
        let editor = document.getElementById('editor');
        let text = editor.value;
        if(!text) return;

        // 1. Remove Markdown Formatting
        text = text.replace(/(\*\*|__)(.*?)\1/g, "$2")
                   .replace(/(\*|_)(.*?)\1/g, "$2")
                   .replace(/^#+\s+/gm, "")
                   .replace(/`{1,3}.*?`{1,3}/gs, "")
                   .replace(/\[([^\]]+)\]\(([^)]+)\)/g, "$1")
                   .replace(/^[*-]\s+/gm, "‚Ä¢ ");

        // 2. Clean up weird mid-word symbols (protects NASA)
        // Only removes symbols if they are NOT letters or numbers
        text = text.replace(/([a-zA-Z0-9])([^a-zA-Z0-9\-\/\s\.!?])([a-zA-Z0-9])/g, "$1$3");

        // 3. Sentence Case: ONLY capitalize the start of sentences
        // This regex looks for the start of the text or a punctuation mark followed by a space
        // and then a lowercase letter, turning only that letter into Uppercase.
        text = text.replace(/(^\s*|[.!?]\s+)([a-z])/g, (m) => m.toUpperCase());

        editor.value = text.trim();
        updateCounts();
        showStatus("Text Purified! ‚ú®");
    }

    // --- CASE CONVERSION ---
    function changeCase(type) {
        const editor = document.getElementById('editor');
        if (!editor || !editor.value) return; 

        if (type === 'upper') {
            editor.value = editor.value.toUpperCase();
            showStatus("Converted to UPPERCASE");
        } else if (type === 'lower') {
            editor.value = editor.value.toLowerCase();
            showStatus("converted to lowercase");
        }    
        updateCounts();
    }

    // --- HELPER FUNCTIONS ---
    function toggleTheme() {
        const body = document.getElementById('bodyTag');
        body.classList.toggle('dark-theme');
        const isDark = body.classList.contains('dark-theme');
        localStorage.setItem('preferred-theme', isDark ? 'dark' : 'light');
        document.getElementById('themeBtn').innerHTML = isDark ? '‚òÄÔ∏è Light' : 'üåì Dark';
    }

    window.onload = () => {
        if (localStorage.getItem('preferred-theme') === 'dark') {
            document.getElementById('bodyTag').classList.add('dark-theme');
            document.getElementById('themeBtn').innerHTML = '‚òÄÔ∏è Light';
        }
    };

    function updateCounts() {
        const text = document.getElementById('editor').value.trim();
        const words = text ? text.split(/\s+/).length : 0;
        const chars = text.length;
        document.getElementById('wordCount').innerText = words;
        document.getElementById('charCount').innerText = chars;
    }

    function replaceText() {
        const findVal = document.getElementById('findInput').value;
        const replaceVal = document.getElementById('replaceInput').value;
        const editor = document.getElementById('editor');
        if (!findVal || !editor.value) return;
        // Use a global regex to replace all instances
        const escapedFind = findVal.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        editor.value = editor.value.replace(new RegExp(escapedFind, 'g'), replaceVal);
        updateCounts();
        showStatus("Text Replaced");
    }

    function handleEnter(e) { if (e.key === "Enter") replaceText(); }

    async function copyText() {
        const editor = document.getElementById('editor');
        try {
            await navigator.clipboard.writeText(editor.value);
            showStatus("Copied to clipboard!");
        } catch (err) { showStatus("Failed to copy"); }
    }

    function clearText() {
        document.getElementById('editor').value = "";
        updateCounts();
        showStatus("Workspace Cleared ‚ú®");
    }

    function showStatus(msg) {
        const status = document.getElementById('statusMessage');
        status.innerText = msg;
        status.style.opacity = "1";
        setTimeout(() => { status.style.opacity = "0"; }, 2000);
    }

    function toggleSpellcheck() {
        const editor = document.getElementById('editor');
        const btn = document.getElementById('spellBtn');
        const isTrue = editor.getAttribute('spellcheck') === 'true';
        editor.setAttribute('spellcheck', !isTrue);
        btn.classList.toggle('active');
        const v = editor.value; editor.value = ''; editor.value = v;
    }

    function confirmRefresh() {
        if (confirm("Do you want to clear your current session and refresh the page?")) {
            window.location.reload();
        } else {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    }
    </script>
</body>
</html>
