<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Text Purifier | Clean ChatGPT & Claude Formatting</title>
    <link rel="stylesheet" href="style.css">  
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚ú®</text></svg>">
    <style>
        /* Word frequency chips */
        .frequency-container {
            margin-top: 15px;
            padding: 10px;
            background: rgba(0,0,0,0.03);
            border-radius: 8px;
            font-size: 0.85em;
        }
        .dark-theme .frequency-container { background: rgba(255,255,255,0.05); }
        .freq-tag {
            display: inline-block;
            background: #64748b;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            margin: 3px;
            font-weight: bold;
        }

        /* Toolbar Layout for Find/Replace */
        .find-replace-row {
            display: flex;
            gap: 8px;
            align-items: center;
            width: 100%;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        /* Reduced size of input boxes */
        .find-replace-row input {
            flex: 1.2; 
            min-width: 100px;
            padding: 8px;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 14px;
            background: var(--container-bg);
            color: var(--text-main);
        }

        .find-replace-row .toolbar-group {
            flex: 2; 
            display: flex;
            gap: 4px;
            min-width: fit-content;
        }

        /* Find, Replace, Replace All same size */
        .find-replace-row button {
            flex: 1;
            padding: 8px 10px; 
            font-size: 12px;   
            white-space: nowrap;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            background-color: #64748b !important; /* Slate */
            color: white !important;
        }

        /* Clear button smaller */
        .btn-small-clear {
            flex: 0 0 35px !important;
            background-color: #f1f5f9 !important;
            color: #ef4444 !important;
            border: 1px solid #fee2e2 !important;
            font-size: 14px !important;
        }

        /* Action Area Button Sizing */
        .action-area {
            display: flex;
            gap: 10px;
            align-items: stretch;
            margin-top: 20px;
        }

        .btn-purify {
            flex: 1.5; /* Larger than others */
            background-color: #4f46e5 !important; /* Deep Indigo */
            color: white !important;
            font-weight: bold;
        }

        .secondary-actions {
            flex: 2.5;
            display: flex;
            gap: 8px;
        }

        /* Copy, Download, Clear same size */
        .secondary-actions button {
            flex: 1;
            padding: 12px 5px;
            font-weight: 600;
            font-size: 13px;
        }

        .btn-copy { background-color: #64748b !important; color: white !important; }
        .btn-download { background-color: #16a34a !important; color: white !important; }
        .btn-clear { 
            background-color: #f1f5f9 !important; 
            color: #ef4444 !important; 
            border: 1px solid #fee2e2 !important; 
        }

        /* Hover effects */
        button:hover { opacity: 0.9; transform: translateY(-1px); }

        .dark-theme .btn-clear, .dark-theme .btn-small-clear {
            background-color: #1e293b !important;
            color: #f87171 !important;
            border-color: #450a0a !important;
        }

        @media (max-width: 600px) {
            .action-area { flex-direction: column; }
            .secondary-actions { width: 100%; }
            .find-replace-row input { flex: 1; }
        }
    </style>
</head>
<body id="bodyTag">

    <nav id="top">
        <div class="nav-container">
            <a href="javascript:void(0)" onclick="confirmRefresh()" class="logo" style="text-decoration: none;">‚ú® CleanTextApp</a>
            <div class="nav-links">
                <button class="theme-toggle" onclick="toggleTheme()" id="themeBtn">üåì Dark Mode</button>
            </div>
        </div>
    </nav>

    <div class="container">
        <header>
            <h1>‚ú® AI Text Purifier</h1>
            <p class="description">Format AI content, fix grammar, and check readability instantly.</p>
        </header>

        <div class="editor-wrapper">
            <div class="toolbar">
                <div class="find-replace-row">
                    <input type="text" id="findInput" placeholder="Find..." oninput="resetSearch()">
                    <input type="text" id="replaceInput" placeholder="Replace...">
                    <div class="toolbar-group">
                        <button onclick="highlightText()">Find</button>
                        <button onclick="replaceSingle()">Replace</button>
                        <button onclick="replaceText()">Replace All</button>
                        <button onclick="clearFindReplace()" class="btn-small-clear" title="Clear Inputs">‚úï</button>
                    </div>
                </div>
                
                <div class="toolbar-group" style="margin-top: 5px; display: flex; gap: 5px;">
                    <button onclick="changeCase('upper')" style="background:#64748b; color:white; border:none; border-radius:4px; padding:6px; font-size:11px; flex:1; cursor:pointer;">UPPERCASE</button>
                    <button onclick="changeCase('lower')" style="background:#64748b; color:white; border:none; border-radius:4px; padding:6px; font-size:11px; flex:1; cursor:pointer;">lowercase</button>
                    <button onclick="changeCase('title')" style="background:#64748b; color:white; border:none; border-radius:4px; padding:6px; font-size:11px; flex:1; cursor:pointer;">Title Case</button>
                </div>
            </div>

            <textarea id="editor" oninput="updateCounts()" spellcheck="true" placeholder="Paste your AI response here..."></textarea>
            
            <div class="counter-bar">
                <div class="stats-left">
                    <span>Words: <b id="wordCount">0</b></span>
                    <span>Chars: <b id="charCount">0</b></span>
                    <span>Reading: <b id="readingTime">0m</b></span>
                </div>
                <div>
                    Readability: <b id="readabilityScore">N/A</b> 
                    <span id="readabilityLevel" class="readability-tag">Ready</span>
                </div>
            </div>

            <div id="frequencyArea" class="frequency-container" style="display:none;">
                <strong>Top Frequent Words:</strong>
                <div id="wordFreqList" style="margin-top: 5px;"></div>
            </div>
        </div>

        <div class="action-area">
            <button class="main-btn btn-purify" onclick="confirmPurify()">‚ú® Purify Text</button>
            <div class="secondary-actions">
                <button class="main-btn btn-copy" id="copyBtn" onclick="copyText()">üìã Copy</button>
                <button class="main-btn btn-download" onclick="downloadText()">üíæ Download</button>
                <button class="main-btn btn-clear" onclick="clearText()">üóëÔ∏è Clear</button>
            </div>
        </div>

        <div id="statusMessage" style="height: 24px; margin-top: 15px; text-align: center; font-weight: 600; color: #16a34a; transition: opacity 0.3s; opacity: 0;"></div>
    </div>

    <footer>
        <p>&copy; 2026 CleanTextApp.com</p>
        <div style="margin-top: 15px;">
            <a href="#top" style="color: #4f46e5; font-weight: bold; margin-right: 15px; text-decoration: none;">Home</a>
            <a href="how-to.html" style="color: var(--text-muted); margin-right: 15px; text-decoration: none;">How-To</a>
            <a href="about.html" style="color: var(--text-muted); margin-right: 15px; text-decoration: none;">About</a>
            <a href="contact.html" style="color: var(--text-muted); margin-right: 15px; text-decoration: none;">Contact</a>
            <a href="privacy.html" style="color: var(--text-muted); margin-right: 15px; text-decoration: none;">Privacy</a>
            <a href="terms.html" style="color: var(--text-muted); text-decoration: none;">Terms</a>
        </div>
    </footer>

    <script>
    function confirmPurify() {
        const message = "Purify will:\n‚Ä¢ Strip Markdown\n‚Ä¢ Clean special characters\n‚Ä¢ Format Sentence Case\n\nProceed?";
        if (confirm(message)) purifyText();
    }

    function purifyText() {
        let editor = document.getElementById('editor');
        let text = editor.value;
        if(!text) return;
        text = text.replace(/(\*\*|__)(.*?)\1/g, "$2").replace(/(\*|_)(.*?)\1/g, "$2")
                   .replace(/^#+\s+/gm, "").replace(/`{1,3}.*?`{1,3}/gs, "")
                   .replace(/\[([^\]]+)\]\(([^)]+)\)/g, "$1").replace(/^[*-]\s+/gm, "‚Ä¢ ");
        text = text.replace(/([a-zA-Z0-9])([^a-zA-Z0-9\-\/\s\.!?])([a-zA-Z0-9])/g, "$1$3");
        text = text.replace(/(^\s*|[.!?]\s+)([a-z])/g, (m) => m.toUpperCase());
        editor.value = text.trim();
        updateCounts();
        showStatus("Text Purified! ‚ú®");
    }

    function changeCase(type) {
        const editor = document.getElementById('editor');
        if (!editor || !editor.value) return; 
        if (type === 'upper') editor.value = editor.value.toUpperCase();
        else if (type === 'lower') editor.value = editor.value.toLowerCase();
        else if (type === 'title') editor.value = editor.value.toLowerCase().replace(/\b\w/g, s => s.toUpperCase());
        updateCounts();
        showStatus("Case Updated");
    }

    function updateFrequency(text) {
        const freqArea = document.getElementById('frequencyArea');
        const freqList = document.getElementById('wordFreqList');
        if (!text || text.length < 10) { freqArea.style.display = 'none'; return; }
        const stopWords = new Set(['the', 'and', 'a', 'to', 'of', 'in', 'is', 'it', 'that', 'on', 'for', 'was', 'as', 'with', 'be', 'this']);
        const words = text.toLowerCase().match(/\b\w+\b/g);
        const counts = {};
        if (words) { words.forEach(w => { if (w.length > 1 && !stopWords.has(w)) counts[w] = (counts[w] || 0) + 1; }); }
        const sorted = Object.entries(counts).sort((a, b) => b[1] - a[1]).slice(0, 8); 
        if (sorted.length > 0) {
            freqArea.style.display = 'block';
            freqList.innerHTML = sorted.map(([word, count]) => `<span class="freq-tag">${word}: ${count}</span>`).join('');
        } else freqArea.style.display = 'none';
    }

    function downloadText() {
        const text = document.getElementById('editor').value;
        if (!text) return;
        const blob = new Blob([text], { type: 'text/plain' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `PurifiedText-${new Date().getTime()}.txt`;
        a.click();
        window.URL.revokeObjectURL(url);
        showStatus("Downloaded! üíæ");
    }

    let searchIndex = 0;
    function highlightText() {
        const editor = document.getElementById('editor');
        const findVal = document.getElementById('findInput').value;
        if (!findVal) return;
        const index = editor.value.toLowerCase().indexOf(findVal.toLowerCase(), searchIndex);
        if (index !== -1) {
            editor.focus();
            editor.setSelectionRange(index, index + findVal.length);
            searchIndex = index + findVal.length;
        } else {
            if (searchIndex !== 0) { searchIndex = 0; alert("No more characters found."); }
            else alert("Text not found.");
        }
    }

    function replaceSingle() {
        const editor = document.getElementById('editor');
        const findVal = document.getElementById('findInput').value;
        const replaceVal = document.getElementById('replaceInput').value;
        if (!findVal) return;
        const start = editor.selectionStart;
        const end = editor.selectionEnd;
        const selectedText = editor.value.substring(start, end);
        if (selectedText.toLowerCase() === findVal.toLowerCase()) {
            editor.setRangeText(replaceVal, start, end, 'end');
            updateCounts();
            searchIndex = editor.selectionStart;
            highlightText();
        } else { highlightText(); }
    }

    function replaceText() {
        const findVal = document.getElementById('findInput').value;
        const replaceVal = document.getElementById('replaceInput').value;
        const editor = document.getElementById('editor');
        if (!findVal) return;
        const escapedFind = findVal.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        editor.value = editor.value.replace(new RegExp(escapedFind, 'gi'), replaceVal);
        updateCounts();
        resetSearch();
        showStatus("Replaced All");
    }

    function resetSearch() { searchIndex = 0; }
    function clearFindReplace() {
        document.getElementById('findInput').value = "";
        document.getElementById('replaceInput').value = "";
        resetSearch();
    }

    function updateCounts() {
        const text = document.getElementById('editor').value.trim();
        const words = text ? text.split(/\s+/).length : 0;
        const chars = text.length;
        document.getElementById('wordCount').innerText = words;
        document.getElementById('charCount').innerText = chars;
        document.getElementById('readingTime').innerText = Math.ceil(words / 200) + "m";
        updateFrequency(text);
    }

    function toggleTheme() {
        const body = document.getElementById('bodyTag');
        body.classList.toggle('dark-theme');
        const isDark = body.classList.contains('dark-theme');
        localStorage.setItem('preferred-theme', isDark ? 'dark' : 'light');
        document.getElementById('themeBtn').innerHTML = isDark ? '‚òÄÔ∏è Light' : 'üåì Dark';
    }

    window.onload = () => {
        if (localStorage.getItem('preferred-theme') === 'dark') {
            document.getElementById('bodyTag').classList.add('dark-theme');
            document.getElementById('themeBtn').innerHTML = '‚òÄÔ∏è Light';
        }
    };

    async function copyText() {
        try {
            await navigator.clipboard.writeText(document.getElementById('editor').value);
            showStatus("Copied! üìã");
        } catch (err) { showStatus("Failed"); }
    }

    function clearText() {
        document.getElementById('editor').value = "";
        updateCounts();
        showStatus("Cleared ‚ú®");
    }

    function showStatus(msg) {
        const status = document.getElementById('statusMessage');
        status.innerText = msg;
        status.style.opacity = "1";
        setTimeout(() => { status.style.opacity = "0"; }, 2000);
    }

    function confirmRefresh() {
        if (confirm("Refresh and clear all text?")) window.location.reload();
        else window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    </script>
</body>
</html>
